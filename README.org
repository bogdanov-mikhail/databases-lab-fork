* Работа с UML

В этой лабораторной работе будем использовать [[https://plantuml.com/][Plant UML]]. Инструкцию по установке вы можете найти [[https://plantuml.com/faq-install][здесь]]. Если вы используете Mac OS, то установить ~plantuml~ можно с помощью ~homebrew~:
#+begin_src
brew install plantuml
#+end_src

* Внешний вид базы данных
[[./db.png]]

* Описание схемы
** ~client~
Таблица клиентов интернет-магазина.

| Поле         | Описание                              | Тип данных |
|--------------+---------------------------------------+------------|
| ~id~           | Первичный ключ, идентификатор клиента | ~UUID~       |
| ~first_name~   | Имя клиента                           | ~VARCHAR~    |
| ~last_name~    | Фамилия клиента                       | ~VARCHAR~    |
| ~phone_number~ | Номер телефона клиента                | ~VARCHAR~    |

** ~payment_method~
Таблица способов оплаты клиента. Реализует возможность нескольких способов оплаты у клиента.

| Поле        | Описание                                     | Тип данных |
|-------------+----------------------------------------------+------------|
| ~id~          | Первичный ключ, идентификатор способа оплаты | ~UUID~       |
| ~card_number~ | Номер платежной карты                        | ~INTEGER~    |
| ~card_owner~  | Имя и фамилия владельца карты                | ~VARCHAR~    |
| ~expire_date~ | Дата истечения срока карты                   | ~DATETIME~   |
| ~cvc~         | CVC код                                      | ~INTEGER~    |
| ~client_id~   | Внешний ключ, идентификатор владельца карты  | ~UUID~       |

** ~payment_info~
Таблица платежных транзакций.

| Поле              | Описание                                           | Тип данных |
|-------------------+----------------------------------------------------+------------|
| ~id~                | Первичный ключ, идентификатор платежной транзакции | ~UUID~       |
| ~payment_method_id~ | Внешний ключ, идентификатор способа оплаты         | ~UUID~       |
| ~order_id~          | Внешний ключ, идентификатор заказа                 | ~UUID~       |

** ~item~
Таблица товаров интернет-магазина одежды.

| Поле  | Описание                             | Тип данных |
|-------+--------------------------------------+------------|
| ~id~    | Первичный ключ, идентификатор товара | ~UUID~       |
| ~name~  | Наименование товара                  | ~VARCHAR~    |
| ~price~ | Стоимость товара                     | ~DECIMAL~    |

** ~tag~
Таблица меток. Метки позволяют объединять товары в некоторые подборки, например подборка черных футболок.

| Поле | Описание                            | Тип данных |
|------+-------------------------------------+------------|
| ~id~   | Первичный ключ, идентификатор метки | ~UUID~       |
| ~name~ | Наименование метки                  | ~VARCHAR~    |

** ~item_tag~
Таблица меток товара. Связывает метки и товары, реализует множественную связь (многие ко многим) между метками и товарами. Таким образом одна метка может относиться к нескольким товарам, равно как и один товар может иметь несколько меток.

| Поле    | Описание                                   | Тип данных |
|---------+--------------------------------------------+------------|
| ~id~      | Первичный ключ, идентификатор метки товара | ~UUID~       |
| ~item_id~ | Внешний ключ, идентификатор товара         | ~UUID~       |
| ~tag_id~  | Внешний ключ, идентификатор метки          | ~UUID~       |

** ~order~
Таблица заказов клиента в определенную точку продаж.

| Поле          | Описание                                 | Тип данных |
|---------------+------------------------------------------+------------|
| ~id~            | Первичный ключ, идентификатор заказа     | ~UUID~       |
| ~client_id~     | Внешний ключ, идентификатор клиента      | ~UUID~       |
| ~sale_point_id~ | Внешний ключ, идентификатор точки продаж | ~UUID~       |

** ~order_item~
Таблица заказов товаров. Связывает заказы клиента и товары, реализует множественную связь (многие ко многим) между заказами и товарами. Таким образом, один товар может быть в нескольких заказах, равно как и несколько товаров может быть в одном заказе.

| Поле     | Описание                                    | Тип данных |
|----------+---------------------------------------------+------------|
| ~id~       | Первичный ключ, идентификатор заказа товара | ~UUID~       |
| ~order_id~ | Внешний ключ, идентификатор заказа          | ~UUID~       |
| ~item_id~  | Внешний ключ, идентификатор товара          | ~UUID~       |

** ~sale_point~
Таблица точек продаж.

| Поле       | Описание                                   | Тип данных |
|------------+--------------------------------------------+------------|
| ~id~         | Первичный ключ, идентификатор точки продаж | ~UUID~       |
| ~address_id~ | Внешний ключ, идентификатор адреса         | ~UUID~       |

** ~sale_point_item~
Таблица товаров на точке продаж. Связывает товары и точки продаж, реализует множественную связь (многие ко многим) между товарами и точками продаж. Таким образом, один товар может быть в нескольких магазинах, равно как и несколько товаров может быть в одном магазине.

| Поле          | Описание                                          | Тип данных |
|---------------+---------------------------------------------------+------------|
| ~id~            | Первичный ключ, идентификатор товара точки продаж | ~UUID~       |
| ~sale_point_id~ | Внешний ключ, идентификатор точки продаж          | ~UUID~       |
| ~item_id~       | Внешний ключ, идентификатор товара                | ~UUID~       |

** ~sale_point_schedule~
Таблица расписаний точек продаж.

| Поле          | Описание                                              | Тип данных |
|---------------+-------------------------------------------------------+------------|
| ~id~            | Первичный ключ, идентификатор расписания точки продаж | ~UUID~       |
| ~schedule_id~   | Внешний ключ, идентификатор расписания                | ~UUID~       |
| ~sale_point_id~ | Внешний ключ, идентификатор точки продаж              |            |

** ~country~
Таблица стран. Предполагается, что магазин может работать не только в России, но и на территории СНГ.

| Поле | Описание                             | Тип данных |
|------+--------------------------------------+------------|
| ~id~   | Первичный ключ, идентификатор страны | ~UUID~       |
| ~name~ | Наименование страны                  | ~VARCHAR~    |

** ~city~
Таблица город. Реализует отношение один ко многим между страной и городами. Таким образом, в стране может быть несколько городов, но город может быть только в одной стране.

| Поле       | Описание                             | Тип данных |
|------------+--------------------------------------+------------|
| ~id~         | Первичный ключ, идентификатор города | ~UUID~       |
| ~name~       | Наименование города                  | ~VARCHAR~    |
| ~country_id~ | Внешний ключ, идентификатор страны   | ~UUID~       |

** ~street~
Таблица улиц. Реализует отношение один ко многим между городом и улицами. Таким образом, в городе может быть несколько улиц, но улица может быть только в одном городе.

| Поле    | Описание                            | Тип данных |
|---------+-------------------------------------+------------|
| ~id~      | Первичный ключ, идентификатор улицы | ~UUID~       |
| ~name~    | Наименование улицы                  | ~VARCHAR~    |
| ~city_id~ | Внешний ключ, идентификатор города  | ~UUID~       |

** ~address~
Таблица адресов (это может быть дом, здание и т. п.). Реализует отношение один ко многим между конкретным адресом и улицей. Таким образом, на улице может быть несколько адресов, но адрес относится только к одной улице.

| Поле         | Описание                             | Тип данных |
|--------------+--------------------------------------+------------|
| ~id~           | Первичный ключ, идентификатор адреса | ~UUID~       |
| ~house_number~ | Номер адреса (дома, здания и т. п.)  | ~VARCHAR~    |
| ~postcode~     | Почтовый индекс                      | ~INTEGER~    |
| ~street_id~    | Внешний ключ, идентификатор улицы    | ~UUID~       |

** ~employee~
Таблица сотрудников магазина.

| Поле          | Описание                                 | Тип данных |
|---------------+------------------------------------------+------------|
| ~id~            | Первичный ключ, идентификатор сотрудника | ~UUID~       |
| ~first_name~    | Имя сотрудника                           | ~VARCHAR~    |
| ~last_name~     | Фамилия сотрудника                       | ~VARCHAR~    |
| ~position_id~   | Внешний ключ, должность сотрудника       | ~UUID~       |
| ~sale_point_id~ | Внешний ключ, идентификатор точки продаж | ~UUID~       |

** ~employee_position~
Таблица должностей сотрудников.

| Поле | Описание                                | Тип данных |
|------+-----------------------------------------+------------|
| ~id~   | Первичный ключ, идентификатор должности | ~UUID~       |
| ~name~ | Наименование должности                  | ~VARCHAR~    |

** ~schedule~
Таблица расписаний. В расписании день недели может быть как конкретным днем недели (Monday, Tuesday и т. д.), так и распространяться на всю неделю (значение All).

| Поле          | Описание                                 | Тип данных |
|---------------+------------------------------------------+------------|
| ~id~            | Первичный ключ, идентификатор расписания | ~UUID~       |
| ~from_time~     | Время начала                             | ~TIME~       |
| ~to_time~       | Время окончания                          | ~TIME~       |
| ~is_break_time~ | Является ли это время перерывом          | ~BOOLEAN~    |
| ~weekday~       | День недели (Monday, ..., Sunday, All)   | ~ENUM~       |
